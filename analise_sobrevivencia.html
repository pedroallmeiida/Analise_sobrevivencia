<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Professor: Pedro Monteiro de Almeida Junior">

<title>Análise de sobrevivência</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="analise_sobrevivencia_files/libs/clipboard/clipboard.min.js"></script>
<script src="analise_sobrevivencia_files/libs/quarto-html/quarto.js"></script>
<script src="analise_sobrevivencia_files/libs/quarto-html/popper.min.js"></script>
<script src="analise_sobrevivencia_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="analise_sobrevivencia_files/libs/quarto-html/anchor.min.js"></script>
<link href="analise_sobrevivencia_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="analise_sobrevivencia_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="analise_sobrevivencia_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="analise_sobrevivencia_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="analise_sobrevivencia_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Análise de sobrevivência</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Professor: Pedro Monteiro de Almeida Junior </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="conteúdo-programático" class="level1">
<h1>Conteúdo programático</h1>
<ol type="1">
<li><strong>Conceitos básicos em análise de dados de sobrevivência</strong>
<ul>
<li><p>Tempos de falha e censura</p></li>
<li><p>Exemplos de uso da análise de sobrevivência</p></li>
<li><p>Representação de dados de sobrevivência</p></li>
<li><p>Funções de interesse e suas relações</p></li>
</ul></li>
<li><strong>Técnicas não paramétricas para análise de sobrevivência</strong>
<ul>
<li><p>Estimador não paramétrico de Kaplan-Meier</p></li>
<li><p>Comparação entre curvas de sobrevivência</p></li>
</ul></li>
<li><strong>Métodos paramétricos para análise de sobrevivência</strong>
<ul>
<li><p>Distribuições básicas em sobrevivência (Exponencial, Weibull e lognormal)</p></li>
<li><p>Procedimentos para a escolha de uma distribuição</p></li>
<li><p>Exemplos práticos no R</p></li>
</ul></li>
<li><strong>Modelos de regressão para a análise de dados de sobrevivência</strong>
<ul>
<li><p>Modelo de regressão exponencial</p></li>
<li><p>Modelo de regressão Weibull</p></li>
<li><p>Modelo de regressão Lognormal</p></li>
<li><p>Análise de Resíduos</p></li>
<li><p>Exemplos práticos no R</p></li>
</ul></li>
<li><strong>Modelo de riscos proporcionais de Cox</strong>
<ul>
<li><p>Modelo de Cox</p></li>
<li><p>Estimação e interpretação dos parâmetros</p></li>
<li><p>Análise de resíduos</p></li>
<li><p>Exemplos práticos no R</p></li>
</ul></li>
</ol>
</section>
<section id="referência-bibliográfica-principal" class="level1">
<h1>Referência bibliográfica principal</h1>
<p>[1] E. A. Colosimo, S. R. Giolo, ANÁLISE DE SOBREVIVÊNCIA APLICADA , Edgard Blucher, São Paulo, 2006.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/livro_imagem.jpg" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="introdução-a-análise-de-sobrevivência" class="level1">
<h1>Introdução a análise de sobrevivência</h1>
<p>O pontapé inicial da análise de sobrevivência foi na área da saúde. Entretanto, ela se aplica em diversas outras áreas de aplicação. É comum se deparar com situações que é necessário obter o tempo até a ocorrência de determinado evento. Por exemplo:</p>
<ul>
<li><p>Tempo até a cura de um paciente</p></li>
<li><p>Tempo até a inadimplência de um cliente</p></li>
<li><p>Tempo até a ocorrência de fraude</p></li>
<li><p>etc …</p></li>
</ul>
<p>Dessa forma, conseguimos determinar a sobrevida de um paciente, produto, clientes, etc… Aqui no curso, o objetivo é avaliar as principais técnicas de análise de sobrevivência e aplicá-las em diversas áres do nosso conhecimento. A sequir, vamos ver os principais conceitos em sobrevivência.</p>
</section>
<section id="conceitos-iniciais" class="level1">
<h1>CONCEITOS INICIAIS</h1>
<p>Em análise de sobrevivência, a nossa variável de interesse é o tempo até a ocorrência de um determinado evento. Esse tempo é o que chamamos de <strong>tempo de falha</strong>. Na área da saúde por exemplo, o tempo de falha poderia ser: o <u>tempo até a cura</u> de um paciente, <u>tempo até a reincidência</u> de uma doença ou <u>tempo até o falecimento</u> do paciente.</p>
<p>Os dados para análise de sobrevivência envolvem uma resposta que é avaliada sobre um período de tempo, que na maioria das vezes será difícil acompanhar todas as observações até a ocorrência do evento. Dessa forma teremos no estudo a presença de observações incompletas. Daí vem o conceito de censura nos dados.</p>
<p><strong>Censura:</strong> a principal característica de dados de sobrevivência é a presença de censura, que é a observação parcial da resposta. Por exemplo, em algumas situações, o acompanhamento do indivíduo presente no estudo é interrompido ( o indivíduo mudou de cidade, faleceu, o estudo finalizou antes de ocorrer o evento desejado, etc…).</p>
<p><strong>Observação:</strong> Sem a presença de censura, as técnicas estatísticas clássicas, como análise de regressão e análise de experimento poderiam ser usadas na análise desse tipo de dado. Por exemplo:</p>
<p><em>Suponha que o interesse seja o de comparar o tempo médio de vida de três grupos de pacientes. Se não houver censuras, podemos usar a análise de variância para fazer a comparação entre os grupos de pacientes usando o tempo médio de vida. Entretanto, se houver censuras, não teremos a informações de pacientes que não concluíram o estudo. Portanto o uso de técnicas de análise de sobrevivência se torna indispensável nesses casos.</em></p>
</section>
<section id="caracterizando-dados-de-sobrevivência" class="level1">
<h1>Caracterizando dados de sobrevivência</h1>
<p>Os dados de sobrevivência são caracterizados por: (i) tempos de falha e (ii) censuras. Estas duas características constituem a nossa variável resposta (ou de interesse). A seguir vamos discutir essas características individualmente.</p>
<section id="tempo-de-falha" class="level2">
<h2 class="anchored" data-anchor-id="tempo-de-falha">Tempo de Falha</h2>
<p><u>Tempo de Sobrevivência ou Falha</u>: Tempo até a ocorrência do evento de interesse.</p>
<p>O tempo de falha é constituído por três elementos:</p>
<p><u>Elementos que definem o tempo de falha:</u></p>
<ol type="1">
<li><p>A escala de medida</p></li>
<li><p>O tempo inicial</p></li>
<li><p>O evento de interesse</p></li>
</ol>
<p>O tempo de sobrevivência vai do tempo inicial até a ocorrência do evento de interesse usando a escala de medida definida.</p>
</section>
<section id="censura" class="level2">
<h2 class="anchored" data-anchor-id="censura">Censura</h2>
<p>É importante ressaltar que mesmo sendo incompletas as observações censuradas nos fornecem informações sobre os tempos de falha. A omissão dessas observações no cálculo das estatísticas de interesse pode acarretar em conclusões viciadas.</p>
<section id="tipos-de-censura" class="level3">
<h3 class="anchored" data-anchor-id="tipos-de-censura">TIPOS DE CENSURA:</h3>
<ol type="1">
<li><p><strong>Censura à direita:</strong> O tempo de falha é superior ao tempo registrado. Desprezar essa informação faria com que o risco de ocorrência do evento de interesse fosse superestimado pois o tempo até a falha é desconhecido mas o evento de interesse não ocorreu até o último momento observado. Existem três conhecidos mecanismos de censura à direita.</p></li>
<li><p><strong>Censura do Tipo I:</strong> O estudo será terminado após um período préestabelecido de tempo. As observações cujo evento de interesse não foi observado até este tempo são ditas censuradas.</p></li>
<li><p><strong>Censura do Tipo II:</strong> O estudo será terminado após ter ocorrido o evento de interesse para um número pré-estabelecido de observações.</p></li>
<li><p><strong>Censura Aleatória:</strong> Ocorre se a observação for retirada no decorrer do estudo sem ter ocorrido o evento de interesse ou se o evento de interesse ocorrer por uma razão diferente da estudada.</p></li>
<li><p><strong>Censura Intervalar:</strong> ocorre quando o evento ocorreu em um certo intervalo. Isto é, o tempo exato da falha não é conhecido exatamente mas pertence a um intervalo. Ocorre por exemplo em estudos em que pacientes são acompanhados em visitas periódicas.</p>
<p><strong>Ilustração dos tipos de censura:</strong></p></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/exemplos_censura.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Fonte: Colosimo &amp; Giolo (2006)</figcaption><p></p>
</figure>
</div>
</section>
</section>
</section>
<section id="representação-dos-dados-de-sobrevivência" class="level1">
<h1>Representação dos dados de sobrevivência</h1>
<p>Os dados de sobrevivência para o indivíduo i <span class="math inline">\(( i = 1, \ldots, n)\)</span> sob estudo são representados, em geral, pelo par <span class="math inline">\((T_i,C_i)\)</span>, sendo <span class="math inline">\(T_i\)</span> o tempo de falha ou censura e <span class="math inline">\(C_i\)</span> a variável indicadora de falha ou censura, isto é,</p>
<p><span class="math display">\[
C_i = \left\{ \begin{array}{ll}
1,&amp; \text{se } T_i \text{ é um tempo de falha} \\
0,&amp; \text{se } T_i \text{ é um tempo censurado}
\end{array} \right.
\]</span></p>
<p>Assim, a variável de interesse em análise de sobrevivência é representada por duas colunas ( Tempo até a falha e censura).</p>
<section id="estrutura-dos-banco-de-dados-de-sobrevivência" class="level2">
<h2 class="anchored" data-anchor-id="estrutura-dos-banco-de-dados-de-sobrevivência">Estrutura dos banco de dados de sobrevivência</h2>
<table class="table">
<thead>
<tr class="header">
<th>Indivíduo (i)</th>
<th>Tempo (T_i)</th>
<th>Censura (C_i)</th>
<th>covariável (X_i)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>10</td>
<td>1</td>
<td>5</td>
</tr>
<tr class="even">
<td>2</td>
<td>15</td>
<td>0</td>
<td>6</td>
</tr>
<tr class="odd">
<td>3</td>
<td>30</td>
<td>1</td>
<td>8</td>
</tr>
</tbody>
</table>
</section>
<section id="exemplos-de-dados-de-sobrevivência" class="level2">
<h2 class="anchored" data-anchor-id="exemplos-de-dados-de-sobrevivência">Exemplos de Dados de Sobrevivência</h2>
<p>Em diversas situações podemos usar técnicas de análise de sobrevivência. A área de maior destaque para essa técnica é a área médica. Podemos usar a análise de sobrevivência para identificar fatores de prognóstico para uma doença, comparação de tratamentos (uma prática bastante comum na área de oncologia, no qual podemos testar se um novo tratamento é melhor que o tratamento usual, ou seja, podemos avaliar se o tempo de sobrevivência de pacientes que aderiram ao novo tratamento é maior). A seguir vamos apresentar alguns exemplos da aplicação de sobrevivência.</p>
<section id="dados-de-hepatite" class="level3">
<h3 class="anchored" data-anchor-id="dados-de-hepatite">1. Dados de Hepatite</h3>
<p>Um estudo clínico aleatorizado foi realizado para investigar o efeito da terapia com esteróide no tratamento de hepatite viral aguda. 29 pacientes com esta doença foram aleatorizados para receber um placebo ou o tratamento com esteróide. Cada paciente foi acompanhado por 16 semanas ou até a morte (evento de interesse) ou até a perda de acompanhamento. Os tempos de sobrevivência observados, em semanas, para os dois grupos são apresentados são dados a seguir:</p>
<table class="table">
<caption>Tabela: Tempos em dia observados no estudo da hepatite</caption>
<colgroup>
<col style="width: 36%">
<col style="width: 30%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th><span class="smallcaps">Grupos</span></th>
<th><span class="smallcaps">Tempo</span></th>
<th><span class="smallcaps">Censura</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">1</span></td>
<td><span class="smallcaps">0</span></td>
</tr>
<tr class="even">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">2</span></td>
<td><span class="smallcaps">0</span></td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">3</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="even">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">3</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">3</span></td>
<td><span class="smallcaps">0</span></td>
</tr>
<tr class="even">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">5</span></td>
<td><span class="smallcaps">0</span></td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">5</span></td>
<td><span class="smallcaps">0</span></td>
</tr>
<tr class="even">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">16</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">16</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="even">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">16</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">16</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="even">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">16</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">16</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="even">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">16</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Controle</span></td>
<td><span class="smallcaps">16</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="even">
<td><span class="smallcaps">Esteróide</span></td>
<td><span class="smallcaps">1</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Esteróide</span></td>
<td><span class="smallcaps">1</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="even">
<td><span class="smallcaps">Esteróide</span></td>
<td><span class="smallcaps">1</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Esteróide</span></td>
<td><span class="smallcaps">1</span></td>
<td><span class="smallcaps">0</span></td>
</tr>
<tr class="even">
<td><span class="smallcaps">Esteróide</span></td>
<td><span class="smallcaps">4</span></td>
<td><span class="smallcaps">0</span></td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Esteróide</span></td>
<td><span class="smallcaps">5</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="even">
<td><span class="smallcaps">Esteróide</span></td>
<td><span class="smallcaps">7</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Esteróide</span></td>
<td><span class="smallcaps">8</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="even">
<td><span class="smallcaps">Esteróide</span></td>
<td><span class="smallcaps">10</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Esteróide</span></td>
<td><span class="smallcaps">10</span></td>
<td><span class="smallcaps">0</span></td>
</tr>
<tr class="even">
<td><span class="smallcaps">Esteróide</span></td>
<td><span class="smallcaps">12</span></td>
<td><span class="smallcaps">0</span></td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Esteróide</span></td>
<td><span class="smallcaps">16</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="even">
<td><span class="smallcaps">Esteróide</span></td>
<td><span class="smallcaps">16</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
<tr class="odd">
<td><span class="smallcaps">Esteróide</span></td>
<td><span class="smallcaps">16</span></td>
<td><span class="smallcaps">1</span></td>
</tr>
</tbody>
</table>
</section>
<section id="outros-exemplos" class="level3">
<h3 class="anchored" data-anchor-id="outros-exemplos">Outros exemplos:</h3>
<ol type="1">
<li><em>Em experimentos padrões na investigação de substâncias cancerígenas, animais em laboratórios são sujeitos a doses de substâncias e então são observados para ver se eles desenvolvem tumores. A principal variável de interesse pode ser o tempo até a ocorrência de tumores ou o tempo até a morte.</em></li>
<li><em>Itens manufaturados de componentes eletrônicos são frequentemente sujeitos a testes de vida para obter informações sobre sua duração. Em laboratórios os itens são observados até a falha.</em></li>
<li>em análise de crédito, podemos estudar o comportamento de clientes para identificar fatores que impactam o tempo até a primeira inadimplência.</li>
</ol>
</section>
</section>
<section id="funções-usadas-para-especificar-o-tempo-de-sobrevivência" class="level2">
<h2 class="anchored" data-anchor-id="funções-usadas-para-especificar-o-tempo-de-sobrevivência">Funções usadas para especificar o tempo de sobrevivência</h2>
<p>O tempo de sobrevivência é uma variável aleatória T, contínua e positiva. Sendo assim, podemos atribuir alguma distribuição de probabilidade para T que pode ser especificada por algumas funções usadas na análise de sobrevivência, dentre as principais estão a função de sobrevivência e taxa de falha. A seguir, vamos apresentar algumas dessas funções.</p>
<section id="função-de-densidade" class="level3">
<h3 class="anchored" data-anchor-id="função-de-densidade">1. Função de densidade</h3>
<p>No contexto de sobrevivência a função <span class="math inline">\(f(t)\)</span> pode ser interpretada como limite da probabilidade de um indivíduo sofrer um evento em um pequeno intervalo por unidade de tempo.</p>
<p>Esta função é definida por</p>
<p><span class="math display">\[
f(t)=\lim _{\Delta t \rightarrow 0} \frac{P(t&lt;T&lt;t+\Delta t)}{\Delta t}
\]</span></p>
<p>Na <strong>ausência de censuras</strong> a f.d.p. pode ser estimada como a proporção de indivíduos que falham em um intervalo por unidade de tempo.</p>
<p><span class="math display">\[
\begin{align}
\hat{f}(t)&amp;=\frac{\text{ Número de ocorrências em }(t, t+\Delta t)}{\left(\text{Número total de ocorrências }\right) \times(\Delta t)} \\
&amp;= \frac{N(t)}{\left(\text{Número total de ocorrências }\right) \times(\Delta t)}
\end{align}
\]</span></p>
</section>
<section id="função-de-sobrevivência" class="level3">
<h3 class="anchored" data-anchor-id="função-de-sobrevivência">2. Função de sobrevivência</h3>
<p>A <strong>função de sobrevivência</strong> é uma das mais importantes e usadas funções em análise de sobrevivência. A função de sobrevivência é definida como a probabilidade de uma observação não falhar (sobreviver) até um certo tempo <em>t.</em> Em termos probabilísticos, isto é escrito como:</p>
<p><span class="math display">\[
S(t) = P(T \geq t).
\]</span></p>
<p>Dessa forma, a <u>distribuição acumulada</u> é definida como:</p>
<p><span class="math display">\[
P(T \leq t) = 1 - S(t)
\]</span></p>
<p>ou seja,a <strong>distribuição acumulada</strong> é a probabilidade de uma observação <strong>não sobreviver</strong> ao tempo <em>t</em>. Na Figura abaixo, temos um exemplo de comparação de curvas de sobrevivência entre dois grupos.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/curvas_sobrevivencia.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Fonte: Colosimo &amp; Giolo (2006)</figcaption><p></p>
</figure>
</div>
<p>Como podemos ver, as curvas de sobrevivência para os dois grupos são diferentes. Em 10 anos, a taxa de sobrevivência para o grupo 1 é de aproximadamente 0.9, enquanto que para o grupo 2 é de 0.5.</p>
<p>Podemos estimar a curva de sobrevivência, quando <u>não há censuras</u>, da seguinte forma:</p>
<p><span class="math display">\[
\begin{align}
\hat S_x(t) &amp;= \frac{ \text{ Número de indivíduos sob risco no início do intervalo de tempo x }}{ \text{Número total de indivíduos} } \\
&amp;= \frac{R(t)}{\text{Número total de indivíduos}}
\end{align}
\]</span></p>
</section>
<section id="função-de-taxa-de-falha-ou-risco" class="level3">
<h3 class="anchored" data-anchor-id="função-de-taxa-de-falha-ou-risco">3. Função de Taxa de Falha (ou risco):</h3>
<p>A função taxa de falha é definida como a probabilidade de um indivíduo sofrer o evento entre o tempo <span class="math inline">\(t\)</span> e <span class="math inline">\(t+\Delta t\)</span>, dado que ele sobreviveu até o tempo <span class="math inline">\(t\)</span>.</p>
<p>Expressa o risco instantâneo de ocorrência de um evento em um pequeno intervalo de tempo, dado que até então o evento não tenha ocorrido.</p>
<p><span class="math display">\[
\begin{align}
h(t)=\lim _{\Delta t \rightarrow 0} \frac{P(t \leq T&lt;t+\Delta t \mid T \geq t)}{\Delta t}
\end{align}
\]</span></p>
<p><strong>IMPORTANTE:</strong> h(t) é uma taxa e não uma probabilidade, pode assumir qualquer valor positivo.</p>
<p>Na ausência de censura a função de risco é estimada por</p>
<p><span class="math display">\[
\hat{h}(t)=\frac{N(t)}{R(t) \times \Delta t}
\]</span></p>
<p><span class="math inline">\(\mathrm{N}(\mathrm{t})\)</span> : Número de eventos observados em cada intervalo de tempo (iniciando em t).</p>
<p><span class="math inline">\(R(t)\)</span> : Número de observações sob risco no início do intervalo.</p>
<p><span class="math inline">\(\Delta t\)</span> : amplitude do intervalo.</p>
<section id="comportamento-da-função-de-risco" class="level4">
<h4 class="anchored" data-anchor-id="comportamento-da-função-de-risco">Comportamento da função de risco</h4>
<p>A função de risco permite analisar o risco de um indivíduo sofrer um evento em um determinado tempo <span class="math inline">\(t\)</span>, dado que ele já sobreviveu até aquele momento. Por exemplo, qual é o risco de um cliente se tornar inadimplente logo após a liberação de um crédito ? Será que o risco é constante ao longo do tempo ? É provável que não. Dessa forma, podemos ter vários tipos de comportamento de risco.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/exemplos_riscos.png" class="img-fluid figure-img" alt="Fonte: Carvalho et al. (2019)"></p>
<p></p><figcaption class="figure-caption">Fonte: Carvalho et al.&nbsp;(2019)</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="função-de-risco-falha-acumulado" class="level3">
<h3 class="anchored" data-anchor-id="função-de-risco-falha-acumulado">Função de risco (falha) acumulado</h3>
<p>A função de risco acumulado <span class="math inline">\(\Lambda(t)\)</span> mede o risco de ocorrênia do evento até um determinado tempo <span class="math inline">\(t\)</span>. Matematicamente, isso significa a soma de todos os riscos em todos os tempos até o tempo <span class="math inline">\(t\)</span>. Como o tempo é uma variável aleatória contínua, <span class="math inline">\(T\)</span>, o risco acumulado é dado por:</p>
<p><span class="math display">\[
\Lambda(t)=\int_0^t \lambda(u) d(u)
\]</span></p>
</section>
<section id="relações-entre-as-funções" class="level3">
<h3 class="anchored" data-anchor-id="relações-entre-as-funções">Relações entre as funções</h3>
<p>Para <span class="math inline">\(T\)</span> uma variável aleatória contínua e não negativa, tem-se, em termos das funções definidas anteriormente, algumas relações matemáticas são estabelecidas:</p>
<p><span class="math display">\[
\begin{align}
&amp;\lambda(t) = \frac{f(t)}{S(t)} = - \frac{d}{d t}[\log S(t)], \\ \\
&amp;\Lambda(t) = - \log S(t), \\ \\
&amp;S(t) = \exp\{ - \Lambda(t) \}
\end{align}
\]</span> Portanto, com o conhecimento de uma das funções, por exemplo <span class="math inline">\(S(t)\)</span>, implica no conhecimento das demais funções, isto é, <span class="math inline">\(F(t)\)</span>, <span class="math inline">\(f(t)\)</span>, <span class="math inline">\(\lambda(t)\)</span> e <span class="math inline">\(\Lambda(t)\)</span>.</p>
</section>
<section id="exercícios" class="level3">
<h3 class="anchored" data-anchor-id="exercícios">Exercícios</h3>
<ol type="1">
<li>Um grande número de indivíduos foi acompanhado para estudar o aparecimento de um certo sintoma. Os indivíduos foram incluídos ao longo do estudo e foi considerado como resposta de interesse a idade em que este sintoma apareceu pela primeira vez. Para os seis indivíduos selecionados e descritos a seguir, identifique o tipo de censura apresentado.</li>
</ol>
<!-- -->
<ol type="a">
<li><p>O primeiro indivíduo entrou no estudo com 25 anos já apresentando o sintoma.</p></li>
<li><p>Outros dois indivíduos entraram no estudo com 20 e 28 anos e não apresentaram o sintoma até o encerramento do estudo.</p></li>
<li><p>Outros dois indivíduos entraram com 35 e 40 anos e apresentaram o sintoma no segundo e no sexto exames respectivamente, após terem entrado no estudo. Os exames foram realizados a cada dois anos.</p></li>
<li><p>O último indivíduo selecionado entrou no estudo com 36 anos e mudou da cidade depois de 4 anos sem ter apresentado o sintoma.</p></li>
</ol>
</section>
<section id="exemplo-no-r" class="level3">
<h3 class="anchored" data-anchor-id="exemplo-no-r">Exemplo no R</h3>
<p>Carregando as bibliotecas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Criando o dataset sem dados censurados</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Criando o dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Grupos <span class="ot">=</span> <span class="fu">c</span>( <span class="fu">rep</span>( <span class="st">"Controle"</span>, <span class="dv">15</span> ), <span class="fu">rep</span>( <span class="st">"Esteroide"</span>, <span class="dv">14</span> )  )</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Tempo <span class="ot">=</span> <span class="fu">c</span>( <span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">16</span>, <span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">16</span>  )</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Censura <span class="ot">=</span> <span class="fu">c</span>( <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">11</span>), <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>  )</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">=</span> <span class="fu">data.frame</span>( Grupos, Tempo, Censura )</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Selecionando apenas dados sem censura</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">=</span> dados <span class="sc">%&gt;%</span> <span class="fu">filter</span>( Censura <span class="sc">==</span> <span class="dv">1</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="técnicas-não-paramétricas-em-sobrevivência" class="level3">
<h3 class="anchored" data-anchor-id="técnicas-não-paramétricas-em-sobrevivência">Técnicas não paramétricas em sobrevivência</h3>
<p>Anteriormente, vimos como estimar a função de sobrevivência e as demais quando não existe a presença de censura. Entretanto, na grande maioria dos casos vamos ter dados censurados, consequentemente teremos que usar técnicas que lidem com dados com censura. Nesta seção, vamos ver técnicas não paramétricas adequadas para esse tipo de situação.</p>
<p>O estimador Kaplan-Meier, também conhecido como estimador produto-limite, será utilizado para estimar a função de sobrevivência, <span class="math inline">\(S(t)\)</span>, e o estimador de Nelson-Aalen para estimar a função de risco acumulado, <span class="math inline">\(\Lambda(t)\)</span>. Na abordagem não paramétrica não é feita qualquer suposição sobre a distribuição probabilística do tempo de sobrevivência <span class="math inline">\(T\)</span>.</p>
</section>
<section id="estimador-de-kaplan-meier" class="level3">
<h3 class="anchored" data-anchor-id="estimador-de-kaplan-meier">Estimador de Kaplan-Meier</h3>
<p>O estimador de Kaplan-Meier é usado para estimar a sobrevivência ( <span class="math inline">\(S(t)\)</span> ) quando existe a presença de censura nos dados. Esse estimador é uma adaptação da função de sobrevivência empírica definida anteriormente quando não temos censuras.</p>
<p><em><strong>Observação:</strong> Quando não existe censuras o estimador de Kaplan-Meier é igual ao definido na seção anterior.</em></p>
<p>O estimador de Kaplan-Meier, na sua construção, leva em consideração as informações censuradas também. Quando analisamos dados com censura, a informação sobre a sobrevivência até a data de sua saída é acessível, isto é, podemos calcular <span class="math inline">\(S(t)\)</span>, para todo <span class="math inline">\(t &lt;\)</span> data de saída. Entretanto, quando olhamos para um <span class="math inline">\(t\)</span> maior que a data de saída, não podemos mais garantir se o indivíduo é um sobrevivente ou não, pois não estava mais sendo acompanhado.</p>
<p>O estimador de Kaplan Meier é proposto com o objetivo de acrescentar a informação de censuras na estimação da sobrevivência. Ele utiliza os conceitos de independência de eventos e de probabilidade condicional para caracterizar a curva de sobrevivência em cada intervalo de tempo anterior a <span class="math inline">\(t\)</span>.</p>
<section id="construção-do-estimador-km" class="level4">
<h4 class="anchored" data-anchor-id="construção-do-estimador-km">Construção do estimador KM</h4>
<p>Sejam <span class="math inline">\(t_1&lt;t_2&lt;\cdots&lt;t_m\)</span> os <span class="math inline">\(m\)</span> diferentes tempos onde ocorreram os eventos em uma amostra com <span class="math inline">\(n\)</span> indivíduos. Denota-se <span class="math inline">\(R\left(t_j\right)\)</span> o número de pessoas no grupo de risco no tempo <span class="math inline">\(t_j\)</span> e <span class="math inline">\(\Delta N\left(t_j\right)\)</span> o número total de eventos ocorridos precisamente em <span class="math inline">\(t_j\)</span>. Assim, para os <span class="math inline">\(m\)</span> tempos <span class="math inline">\(t_j\)</span> em que ocorre um evento, a probabilidade de sobrevivência será estimada pelo número de sobreviventes no tempo <span class="math inline">\(t_j\left(R\left(t_j\right)-\Delta N\left(t_j\right)\right)\)</span> sobre os que estavam em risco naquele tempo <span class="math inline">\(\left(R\left(t_j\right)\right)\)</span>. Como os eventos são independentes, a função de sobrevivência <span class="math inline">\(S(t)\)</span> é estimada empiricamente pelo produto das probabilidade de sobrevivência a cada tempo <span class="math inline">\(t_j \leq t\)</span> :</p>
<p><span class="math display">\[
\begin{aligned}\widehat{S}_{\mathrm{km}}(t) &amp;=\frac{R\left(t_1\right)-\Delta N\left(t_1\right)}{R\left(t_1\right)} \times \frac{R\left(t_2\right)-\Delta N\left(t_2\right)}{R\left(t_2\right)} \times \cdots \\&amp; \times \frac{R\left(t_m\right)-\Delta N\left(t_m\right)}{R\left(t_m\right)}=\\&amp;=\prod_{j: t_j \leq t} \frac{R\left(t_j\right)-\Delta N\left(t_j\right)}{R\left(t_j\right)}=\\&amp;=\prod_{j: t_j \leq t} 1-\frac{\Delta N\left(t_j\right)}{R\left(t_j\right)} .\end{aligned}
\]</span></p>
<p>A mesma equação pode ser apresentada na forma recursiva como:</p>
<p><span class="math display">\[
\widehat{S}_{\mathrm{km}}\left(t_j\right)=\widehat{S}_{\mathrm{km}}\left(t_{j-1}\right) \times \frac{R\left(t_j\right)-\Delta N\left(t_j\right)}{R\left(t_j\right)}
\]</span></p>
</section>
</section>
<section id="principais-propriedades-do-estimador-km" class="level3">
<h3 class="anchored" data-anchor-id="principais-propriedades-do-estimador-km">PRINCIPAIS PROPRIEDADES DO ESTIMADOR KM:</h3>
<ul>
<li><p>É o estimador de máxima verossimilhança de <span class="math inline">\(\mathrm{S}(\mathrm{t})\)</span>;</p></li>
<li><p>É não-viciado para amostras grandes;</p></li>
<li><p>É fracamente consistente;</p></li>
<li><p>Converge assintoticamente para um processo Gaussiano.</p></li>
</ul>
<section id="exemplo-tempo-de-sobrevivência-dias-de-alguns-pacientes-da-coorte-de-aids-do-ipec." class="level4">
<h4 class="anchored" data-anchor-id="exemplo-tempo-de-sobrevivência-dias-de-alguns-pacientes-da-coorte-de-aids-do-ipec.">Exemplo: Tempo de sobrevivência (dias) de alguns pacientes da coorte de Aids do Ipec.</h4>
<p><span class="math display">\[
\begin{aligned}&amp;60 \,\, 84 \,\, 25+\,\, 54 \,\, 80+ \,\, 37\,\,18 \,\, 29\,\, 50+\,\, 83 \,\, 80 \\&amp;81+ \,\,35\,\,52\,\,21\,\,40\,\,22\,\,85+\,\,39\,\,16\,\,21+\end{aligned}
\]</span>Neste exemplo foram avaliados 21 indivíduos, dos quais 15 morreram (falhou) e 6 foram censurados.</p>
<p>Para calcular a sobrevivência pelo estimador de KM, temos que primeiro obter os tempos de sobrevivência sem censuras, que correspondem ao tempo <span class="math inline">\(t_j\)</span>, com <span class="math inline">\(j = 1, \ldots, 15\)</span>. Na tabela seguinte, é possível ver os resultados das quantidades estimados pelo modelo KM.</p>
<p>Tab: Estimacão de sobrevivência por Kaplan-Meier<br>
</p>
<p><span class="math display">\[
\begin{array}{cccrr}\hline t_j &amp; R(t) &amp; \Delta N(t) &amp; \widehat{S}_{\mathrm{km}}(t)=\prod_{t_j \leq t} \frac{R\left(t_j\right)-\Delta N\left(t_j\right)}{R\left(t_j\right)} \\\hline 16 &amp; 21 &amp; 1 &amp; \left(\frac{21-1}{21}\right)=0,9524 \\18 &amp; 20 &amp; 1 &amp; 0,9524 \times\left(\frac{20-1}{20}\right)=0,9048 \\21 &amp; 19 &amp; 1 &amp; 0,9048 \times\left(\frac{19-1}{19}\right)=0,8571 \\22 &amp; 17 &amp; 1 &amp; 0,8571 \times\left(\frac{17-1}{17}\right)=0,8067 \\29 &amp; 15 &amp; 1 &amp; 0,8067 \times\left(\frac{15-1}{15}\right)=0,7529 \\35 &amp; 14 &amp; 1 &amp; 0,7529 \times\left(\frac{14-1}{14}\right)=0,6992 \\37 &amp; 13 &amp; 1 &amp; 0,6992 \times\left(\frac{13-1}{13}\right)=0,6454 \\39 &amp; 12 &amp; 1 &amp; 0,6454 \times\left(\frac{12-1}{12}\right)=0,5916 \\40 &amp; 11 &amp; 1 &amp; 0,5916 \times\left(\frac{11-1}{11}\right)=0,5378 \\52 &amp; 9 &amp; 1 &amp; 0,5378 \times\left(\frac{9-1}{9}\right)=0,4781 \\54 &amp; 8 &amp; 1 &amp; 0,4781 \times\left(\frac{8-1}{8}\right)=0,4183 \\60 &amp; 7 &amp; 1 &amp; 0,4183 \times\left(\frac{7-1}{7}\right)=0,3585 \\80 &amp; 6 &amp; 1 &amp; 0,3585 \times\left(\frac{6-1}{6}\right)=0,2988 \\83 &amp; 3 &amp; 1 &amp; 0,2988 \times\left(\frac{3-1}{3}\right)=0,1992 \\84 &amp; 2 &amp; 1 &amp; 0,1992 \times\left(\frac{2-1}{2}\right)=0,0996 \\\hline\end{array}
\]</span></p>
</section>
</section>
<section id="código-r" class="level3">
<h3 class="anchored" data-anchor-id="código-r">Código R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'survival' was built under R version 4.1.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tempo <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">84</span>, <span class="dv">25</span>, <span class="dv">54</span>,<span class="dv">80</span>,<span class="dv">37</span>,<span class="dv">18</span>,<span class="dv">29</span>,<span class="dv">50</span>,<span class="dv">83</span>,<span class="dv">80</span>,<span class="dv">81</span>,<span class="dv">35</span>,<span class="dv">52</span>,<span class="dv">21</span>,<span class="dv">40</span>,<span class="dv">22</span>,<span class="dv">85</span>,<span class="dv">39</span>,<span class="dv">16</span>,<span class="dv">21</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>censura <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">=</span> <span class="fu">data.frame</span>( tempo, censura )</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">=</span> <span class="fu">survfit</span>( <span class="fu">Surv</span>( tempo, censura   )<span class="sc">~</span><span class="dv">1</span>, dados  )</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(tempo, censura) ~ 1, data = dados)

 time n.risk n.event survival std.err lower 95% CI upper 95% CI
   16     21       1   0.9524  0.0465       0.8655        1.000
   18     20       1   0.9048  0.0641       0.7875        1.000
   21     19       1   0.8571  0.0764       0.7198        1.000
   22     17       1   0.8067  0.0869       0.6531        0.996
   29     15       1   0.7529  0.0963       0.5859        0.968
   35     14       1   0.6992  0.1034       0.5232        0.934
   37     13       1   0.6454  0.1085       0.4642        0.897
   39     12       1   0.5916  0.1120       0.4082        0.857
   40     11       1   0.5378  0.1140       0.3550        0.815
   52      9       1   0.4781  0.1160       0.2972        0.769
   54      8       1   0.4183  0.1158       0.2431        0.720
   60      7       1   0.3585  0.1137       0.1926        0.667
   80      6       1   0.2988  0.1093       0.1459        0.612
   83      3       1   0.1992  0.1092       0.0680        0.583
   84      2       1   0.0996  0.0891       0.0172        0.575</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="at">xlab =</span> <span class="st">'Tempo (Dias)'</span>, <span class="at">ylab=</span> <span class="st">'S(t)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="analise_sobrevivencia_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A partir da estimação da sobrevivência podemos encontrar o estimador do risco acumulado de Kaplan-Meier:</p>
<p><span class="math display">\[
\hat \Lambda_{KM}(t)= - \ln \left( \hat S_{KM}(t) \right)
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="at">xlab =</span> <span class="st">'Tempo (Dias)'</span>, <span class="at">ylab=</span> <span class="st">'Risco Acumulado(t)'</span>, <span class="at">fun =</span> <span class="st">'cumhaz'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="analise_sobrevivencia_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="estimador-nelson-aalen" class="level3">
<h3 class="anchored" data-anchor-id="estimador-nelson-aalen">Estimador Nelson Aalen</h3>
<p>Uma alternativa para estimar o risco acumulado é o estimador de Nelson-Aalen. Ele foi proposto por Nelson (1972) e retomado por Aalen (1978), no qual demonstrou as propriedades assintóticas do estimador. Esse estimador pode ser obtido através da seguinte expressão:</p>
<p><span class="math display">\[
\tilde \Lambda_{NA}(t) = \sum_{j: t_j &lt; t} \left( \frac{\Delta N(t_j)}{R(t_j)} \right)
\]</span></p>
<p>Dessa forma, também podemos obter o estimador de <span class="math inline">\(S(t)\)</span> de Nelson-Aalen, tal que,</p>
<p><span class="math display">\[
\tilde S_{NA}(t) = \exp\{ - \tilde \Lambda_{NA}(t)  \}
\]</span></p>
</section>
<section id="comparação-de-curvas-de-sobrevivência" class="level3">
<h3 class="anchored" data-anchor-id="comparação-de-curvas-de-sobrevivência">Comparação de curvas de sobrevivência</h3>
<p>O problema de <strong>comparação</strong> <strong>de distribuições de sobrevivência</strong> surge com frequência em estudos de sobrevivência. Por exemplo, pode ser de interesse comparar dois tratamentos para uma determinada doença.</p>
<p>Um caminho simples é a <u>observação do gráfico</u> das funções de sobrevivência estimadas. Contudo esse gráfico fornece apenas uma idéia aproximada da diferença entre essas distribuições. Ele não revela se as diferenças são significativas. Para comparar as curvas de sobrevivência mais formalmente, podemos recorrer a <strong>testes de hipóteses.</strong></p>
<section id="teste-log-rank" class="level4">
<h4 class="anchored" data-anchor-id="teste-log-rank">Teste Log-Rank</h4>
<p>Para confirmar estatisticamente se as curvas de sobrevivência entre grupos são realmente distintas, vamos recorrer aos testes de hipóteses. O teste log-Rank ( ou Mantel- Hanzel) é usado para essa finalidade.</p>
</section>
<section id="como-funciona-o-teste" class="level4">
<h4 class="anchored" data-anchor-id="como-funciona-o-teste">Como funciona o teste ?</h4>
<p>O teste de log-rank compara a <u>distribuição da ocorrência</u> dos eventos observados em cada estrato com a distribuição que seria <u>esperada</u> se a incidência fosse igual em todos os estratos.</p>
<p>Se a distribuição observada for equivalente à distribuição esperada, dizemos que a curva de sobrevivência dos pacientes pertencentes ao estrato é equivalente à curva de sobrevivência dos pacientes em geral (a covariável não tem efeito na sobrevida).</p>
<p><strong>Realização do teste:</strong></p>
<p><strong>Hipótese nula:</strong> não há diferença entre estratos.</p>
<p>Estima-se o número de eventos esperados para cada estrato <span class="math inline">\(\mathrm{k}\)</span>, segundo a hipótese nula de incidência igual em cada estrato.</p>
<p><strong>Distribuição esperada</strong> de eventos igual em todos os estratos:</p>
<p><span class="math display">\[
E_k(t)= \Delta N(t) \frac{R_k(t)}{R(t)}
\]</span></p>
<p>em que <span class="math inline">\(\Delta N(t)\)</span> é o número total de eventos observados. <span class="math inline">\(R_k(t)\)</span> é o número de pessoas em risco no estrato <span class="math inline">\(k\)</span>. <span class="math inline">\(R(t)\)</span> é o número total de pessoas em risco no estudo no tempo t.</p>
<p><strong>Estatística de teste</strong> log-rank para dois estratos $(k=2)$ :</p>
<p><span class="math display">\[
\text { Log-rank }=\frac{\left(O_1-E_1\right)^2}{\operatorname{Var}\left(O_1-E_1\right)}
\]</span></p>
<p><span class="math inline">\(O_1=\)</span> total de eventos observados no estrato 1</p>
<p><span class="math inline">\(E_1=\)</span> total de eventos esperados no estrato 1 .</p>
<p><span class="math display">\[
\operatorname{Var}\left(O_1-E_1\right)=\sum_t \frac{R_1(t) R_2(t) \Delta N(t)[R(t)-\Delta N(t)]}{R(t)^2[R(t)-1]}
\]</span></p>
<p>A estatística log-rank, sob a hipótese nula, segue uma distribuição <span class="math inline">\(\chi^2\)</span>, com <span class="math inline">\(k-1\)</span> graus de liberdade.</p>
<p><strong>Observação:</strong> Apesar de introduzir o teste log-rank para dois estratos, a sua generalização para <span class="math inline">\(k\)</span> estratos também é válida.</p>
</section>
</section>
<section id="teste-de-peto" class="level3">
<h3 class="anchored" data-anchor-id="teste-de-peto">Teste de Peto</h3>
<p>Dá maior peso às diferenças (ou semelhanças), no início da curva, onde se concentra a maior parte dos dados e por isso é mais informativa. Usa um ponderador <span class="math inline">\(S(t)\)</span> no estimador.</p>
<p><span class="math display">\[
\text { Peto }=\frac{\left(O_1-E_1\right)^2}{\operatorname{Var}\left(O_1-E_1\right)}
\]</span></p>
<p>sendo que</p>
<p><span class="math display">\[
O_1-E_1=\sum_{t_j} S\left(t_j\right)\left(O_1\left(t_j\right)-E_1\left(t_j\right)\right)
\]</span></p>
<p>Também a estatística Peto segue aproximadamente uma distribuição <span class="math inline">\(\chi^2\)</span> com <span class="math inline">\(k-1\)</span> graus de liberdade.</p>
<p>A variância da estatística de Peto é igual a variância do log-rank, onde a cada tempo se pondera pelo quadrado da função de sobrevida.</p>
<section id="no-r" class="level4">
<h4 class="anchored" data-anchor-id="no-r">No R</h4>
<p>Para fazer comparações de curvas de sobrevivência no R, basta usar a função <code>survdiff( ).</code></p>
<p>Exemplo: Dados de Hepatite</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tempo<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">16</span>) </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>cens<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>) </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>grupos<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">15</span>),<span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">14</span>)) </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Para rodar o teste log-rank, faça rho = 0</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(tempo,cens)<span class="sc">~</span>grupos,<span class="at">rho=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(tempo, cens) ~ grupos, rho = 0)

          N Observed Expected (O-E)^2/E (O-E)^2/V
grupos=1 15        2     4.81      1.64      3.67
grupos=2 14        7     4.19      1.89      3.67

 Chisq= 3.7  on 1 degrees of freedom, p= 0.06 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Para rodar o teste Peto, faça rho = 1</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(tempo,cens)<span class="sc">~</span>grupos,<span class="at">rho=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(tempo, cens) ~ grupos, rho = 1)

          N Observed Expected (O-E)^2/E (O-E)^2/V
grupos=1 15     1.79     4.16      1.35      3.43
grupos=2 14     6.00     3.63      1.54      3.43

 Chisq= 3.4  on 1 degrees of freedom, p= 0.06 </code></pre>
</div>
</div>
</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>